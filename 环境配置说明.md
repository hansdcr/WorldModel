# Python 虚拟环境配置说明

> **项目**: 世界模型学习项目
> **Python 版本**: 3.12.3
> **虚拟环境**: venv
> **最后更新**: 2025-11-21

---

## ✅ 环境已配置完成

虚拟环境已经创建并配置好，你可以直接开始使用！

### 当前配置
```
✅ Python 版本: 3.12.3
✅ 虚拟环境路径: venv/
✅ 已安装基础依赖:
   - numpy 2.2.6
   - matplotlib 3.10.7
   - opencv-python 4.12.0.88
   - pillow 12.0.0
   - tqdm 4.67.1
   - jupyter 1.1.1
   + 其他依赖库 (详见 requirements.txt)
```

---

## 🚀 快速开始

### 方法 1: 使用便捷脚本（推荐）

```bash
# 激活虚拟环境
source activate_env.sh

# 运行迭代 1 的代码
./run_iteration.sh 1
```

### 方法 2: 手动激活

```bash
# 进入项目目录
cd /Users/gelin/Desktop/store/dev/python/3.10/WorldModel

# 激活虚拟环境
source venv/bin/activate

# 运行代码
python code/iteration_01/spatial_concept.py
```

---

## 📋 常用命令

### 激活虚拟环境
```bash
source venv/bin/activate
```

**验证激活成功**:
- 命令行提示符前会显示 `(venv)`
- 运行 `which python` 应该显示虚拟环境中的 Python 路径

### 退出虚拟环境
```bash
deactivate
```

### 查看已安装的包
```bash
source venv/bin/activate
pip list
```

### 安装新的包
```bash
source venv/bin/activate
pip install package_name
```

---

## 📦 依赖管理

### 查看当前依赖
```bash
source venv/bin/activate
pip list
```

### 安装完整依赖（如需重新安装）
```bash
source venv/bin/activate
pip install -r requirements.txt
```

### 更新 requirements.txt（添加新依赖后）
```bash
source venv/bin/activate
pip freeze > requirements.txt
```

### 分阶段安装依赖（推荐给初学者）

**迭代 1-6（基础阶段）**:
```bash
pip install numpy matplotlib opencv-python pillow
```

**迭代 7-14（多模态阶段）**:
```bash
pip install torch torchvision transformers diffusers open-clip-torch
```

**迭代 15-22（3D 处理阶段）**:
```bash
pip install pytorch3d open3d trimesh pymeshlab
```

**迭代 23+（高级阶段）**:
```bash
# 根据需要安装其他库
```

---

## 🔧 故障排查

### 问题 1: 虚拟环境无法激活

**症状**: 运行 `source venv/bin/activate` 报错

**解决方案**:
```bash
# 重新创建虚拟环境
rm -rf venv
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

### 问题 2: Python 版本不对

**症状**: `python --version` 显示的不是 3.12.x

**解决方案**:
```bash
# 确认虚拟环境已激活（提示符应该有 (venv)）
source venv/bin/activate

# 再次检查版本
python --version
```

### 问题 3: 包导入错误

**症状**: `ImportError: No module named 'xxx'`

**解决方案**:
```bash
# 确认虚拟环境已激活
source venv/bin/activate

# 安装缺失的包
pip install xxx

# 或重新安装所有依赖
pip install -r requirements.txt
```

### 问题 4: matplotlib 中文显示乱码

**症状**: 图表中的中文显示为方框

**解决方案**:
```python
# 在代码开头添加
import matplotlib
matplotlib.rcParams['font.sans-serif'] = ['Arial Unicode MS']  # macOS
# 或
matplotlib.rcParams['font.sans-serif'] = ['SimHei']  # Windows
matplotlib.rcParams['axes.unicode_minus'] = False
```

---

## 💡 最佳实践

### 1. 每次开始学习前
```bash
# 激活虚拟环境
source activate_env.sh

# 或手动激活
source venv/bin/activate
```

### 2. 每次结束学习后
```bash
# 可以不退出虚拟环境，下次直接使用
# 如果要退出:
deactivate
```

### 3. 运行代码时
```bash
# 始终确保虚拟环境已激活
# 提示符应该显示 (venv)

python code/iteration_XX/filename.py
```

### 4. 安装新依赖时
```bash
# 1. 激活虚拟环境
source venv/bin/activate

# 2. 安装依赖
pip install package_name

# 3. 更新 requirements.txt
pip freeze > requirements.txt
```

---

## 📊 环境信息

### Python 版本
```
Python 3.12.3
```

### 虚拟环境位置
```
/Users/gelin/Desktop/store/dev/python/3.10/WorldModel/venv
```

### 核心依赖版本
```
numpy==2.2.6
matplotlib==3.10.7
opencv-python==4.12.0.88
pillow==12.0.0
tqdm==4.67.1
jupyter==1.1.1
```

完整依赖列表请查看 `requirements.txt`

---

## 🎓 为什么使用虚拟环境？

### 优点
1. **隔离性**: 不同项目的依赖互不干扰
2. **可复现**: 可以精确控制依赖版本
3. **安全性**: 不会污染系统 Python 环境
4. **可移植**: 通过 requirements.txt 轻松迁移

### 类比
```
虚拟环境 = 独立的工作空间

系统 Python = 公共厨房
虚拟环境 = 你的私人厨房

在私人厨房里:
- 可以随意添加调料（安装依赖）
- 不会影响公共厨房（系统环境）
- 可以随时清理重来（删除虚拟环境）
```

---

## 📞 需要帮助？

如果遇到环境问题：

1. **查看本文档的故障排查章节**
2. **检查 CLAUDE.md 的虚拟环境要求**
3. **运行验证脚本**: `source activate_env.sh`
4. **查看错误信息并搜索解决方案**

---

## 🔄 环境重建（如果需要）

如果虚拟环境出现无法解决的问题，可以完全重建：

```bash
# 1. 删除旧的虚拟环境
cd /Users/gelin/Desktop/store/dev/python/3.10/WorldModel
rm -rf venv

# 2. 创建新的虚拟环境
python3 -m venv venv

# 3. 激活虚拟环境
source venv/bin/activate

# 4. 升级 pip
pip install --upgrade pip

# 5. 安装依赖
pip install -r requirements.txt

# 6. 验证
python --version
pip list
```

---

**配置完成时间**: 2025-11-21
**环境验证**: ✅ 通过
**可以开始学习**: ✅ 是
